<!DOCTYPE html>
<!-- saved from url=(0054)https://mice2.tako.life/meettaiwan/training/mice/books -->
<html lang="zh-TW"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>會展人才培育與認證</title>
    <meta name="description" content="培育我國會展產業從業人員之專業技能，建立會展產業認證制度及人才資料庫，逐步提昇人才素質，促使台灣會展人才資源適才適用。">
    <meta name="keywords" content="會展">
    <meta name="csrf-token" content="VLVnfTSh8rnfY5iemyeqHgWC2JKT9q8tRXH3fNrA">
    <link href="https://mice2.tako.life/meettaiwan/training/mice/img/logo.png" rel="shortcut icon" type="image/png">
    <!-- CSS -->
    <link rel="stylesheet" href="./國內認證叢書_files/bootstrap.min.css">
    <link rel="stylesheet" href="./國內認證叢書_files/swiper-bundle.min.css">
    <link rel="stylesheet" href="./國內認證叢書_files/aos.css">
    <link rel="stylesheet" href="./國內認證叢書_files/layout.css">
    <link rel="stylesheet" href="./國內認證叢書_files/lightbox.css">
    <link rel="stylesheet" href="./國內認證叢書_files/functional.css">

    <!-- JS -->
    <script async="" src="./國內認證叢書_files/gtm.js.下載"></script><script src="./國內認證叢書_files/jquery.min.js.下載"></script>
    <script src="./國內認證叢書_files/bootstrap.bundle.min.js.下載"></script>
    <script src="./國內認證叢書_files/swiper-bundle.min.js.下載"></script>
    <script src="./國內認證叢書_files/aos.js.下載"></script>
    <script src="./國內認證叢書_files/into.js.下載"></script>
    <link rel="stylesheet" href="./國內認證叢書_files/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous">
    <script src="./國內認證叢書_files/jquery.cookie.min.js.下載"></script>
    <script src="./國內認證叢書_files/lazyload.js.下載"></script>
    <script>
        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            }
        });
        let myPlugin = {};
    </script>
    <!-- Google tag (gtag.js) -->
    <script async="" src="./國內認證叢書_files/js"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());
        gtag('config', 'G-4SLCWHF0HP', { cookie_flags: 'SameSite=None;Secure',cookie_expires: 0 });
    </script>
    <!-- Google Tag Manager -->
    <script>
        (function(w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-W9GK2WL');
    </script>
    <!-- End Google Tag Manager -->

    <link href="./國內認證叢書_files/bootstrap-4.css" rel="stylesheet">
    <script src="./國內認證叢書_files/sweetalert2.min.js.下載"></script>
</head>

<body>

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W9GK2WL" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- HEADER -->
    <!-- 表頭 -->
<header class="c-header">
    <div class="header-block">
        <div class="container-fluid">
            <div class="row">
                <div class="col-logo">
                    <div class="logo"><a href="https://jacko0322.github.io/HW2/首頁.html"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/logo_2023_07_03.png" src="./首頁_files/logo_2023_07_03.png"></a></div>
                </div>
                <div class="col-menu collapse navbar-collapse" id="collapsibleNavbar">
                    <div class="menu-outer">
                        <ul class="nav">
                            <li class="nav-item"><a href="https://jacko0322.github.io/HW2/首頁.html" class="nav-link active">首頁</a></li>
                            <li class="nav-item dropdown ">
                                <a href="javascript:void(0);" class="nav-link dropdown-toggle " data-hover="dropdown">關於MICE</a>
                                <div class="dropdown-menu">
                                    <a href="https://jacko0322.github.io/HW2/計畫介紹.html" class="dropdown-item ">計畫介紹</a>
                                    <a href="https://jacko0322.github.io/HW2/職能基準.html" class="dropdown-item">職能基準</a>
                                    
                                </div>
                            </li>
                            <li class="nav-item"><a href="https://jacko0322.github.io/HW2/最新消息.html" class="nav-link">最新消息</a></li>
                            <li class="nav-item dropdown">
                                <a href="javascript:void(0);" class="nav-link dropdown-toggle" data-hover="dropdown">課程與認證</a>
                                <div class="dropdown-menu">
                                    <a href="https://jacko0322.github.io/HW2/會展沙龍.html" class="dropdown-item">會展沙龍</a>
                                    <span class="dropdown-item dropdown-submenu">
                                        <a href="javascript:void(0);">國際認證</a>
                                        <ul class="dropdown-menu">
                                            <a href="https://jacko0322.github.io/HW2/國際認證培訓及考試.html" class="dropdown-item">國際認證培訓及考試</a>
                                            <a href="https://jacko0322.github.io/HW2/國際認證介紹.html" class="dropdown-item">國際認證介紹</a>
                                            
                                        </ul>
                                    </span>
                                    <span class="dropdown-item dropdown-submenu">
                                        <a href="javascript:void(0);">國內認證</a>
                                        <ul class="dropdown-menu">
                                            <a href="https://jacko0322.github.io/HW2/國內認證培訓.html" class="dropdown-item">國內認證培訓</a>
                                            <a href="https://jacko0322.github.io/HW2/國內認證考試.html" class="dropdown-item">國內認證考試</a>
                                            <a href="https://jacko0322.github.io/HW2/國內認證叢書.html" class="dropdown-item">國內認證叢書</a>
                                        </ul>
                                    </span>
                                    
                                    <a href="https://jacko0322.github.io/HW2/常見問題.html" class="dropdown-item">常見問題</a>
                                    <a href="https://jacko0322.github.io/HW2/文件下載.html" class="dropdown-item">文件下載</a>
                                    
                                </div>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="javascript:void(0);" class="nav-link dropdown-toggle" data-hover="dropdown">活動花絮</a>
                                <div class="dropdown-menu">
                                    <a href="https://jacko0322.github.io/HW2/影音.html" class="dropdown-item">影音</a>
                                    <a href="https://jacko0322.github.io/HW2/照片.html" class="dropdown-item">照片</a>
                                    <a href="https://jacko0322.github.io/HW2/會展視覺專區.html" id="vrswitch" class="dropdown-item" style="">VR/AR會展視覺專區</a>
                                </div>
                            </li>
                            <li class="nav-item">
                                <form class="search-outer" action="https://mice2.tako.life/meettaiwan/training/mice/search">
                                    <input type="text" name="kw" class="form-control">
                                    <button type="submit" class="btn btn-search"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_search.svg" src="./國內認證叢書_files/icon_search.svg"></button>
                                </form>
                            </li>
                            <li class="nav-item nav-shoppingcart">
                                <a href="https://mice2.tako.life/meettaiwan/training/mice/shoppingCart" class="nav-link"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_shoppingcart.svg" src="./國內認證叢書_files/icon_shoppingcart.svg"><span></span></a>
                            </li>

                                                        <li class="nav-item nav-login">
                                <a href="https://mice2.tako.life/meettaiwan/training/mice/login" class="nav-link">登入</a>
                            </li>
                            
                            <li class="nav-item nav-elearning">
                                <a href="https://mice2.tako.life/meettaiwan/training/mice/home/index" class="nav-link"><i class="icon"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_elearning.png" src="./國內認證叢書_files/icon_elearning.png"></i>E化學院</a>
                            </li>
                            <li class="nav-item nav-job">
                                <a href="https://mice2.tako.life/meettaiwan/training/mice/course/%E6%9C%83%E5%B1%95%E6%B2%99%E9%BE%8D" class="nav-link"><i class="icon"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_job.png" src="./國內認證叢書_files/icon_job.png"></i>會展沙龍</a>
                            </li>
                            
                        </ul>
                    </div>
                </div>
                <div class="col-btnmenu">
                    <a href="https://mice2.tako.life/meettaiwan/training/mice/shoppingCart" class="navbar-toggler navbar-shoppingcart">
                        <img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_shoppingcart.svg" src="./國內認證叢書_files/icon_shoppingcart.svg">
                    </a>
                    <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#collapsibleNavbar">
                        <img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_menu.png" src="./國內認證叢書_files/icon_menu.png">
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script>
        $(() => {
            $('#collapsibleNavbar').find('li').eq(3).find('a').eq(0).addClass('active');

            //header的購物車上的數量
            if(!$.cookie("cart")) $.cookie("cart", JSON.stringify([]), {  path: '/' ,
                secure: true})
            var cart =JSON.parse($.cookie("cart"));
            if(cart && cart.length>0){
                $('#collapsibleNavbar').find('li').eq(6).find('a').eq(0).find('span').eq(0).html(cart.length);
            }
        });
    </script>
</header>

    <!-- HEADER 結束-->

    <!-- MAIN -->
        <!-- 內容 -->
    <section class="c-main" style="padding-top: 37.6px;">
        <div class="pageheader-block" data-src="https://picbackup.github.io/mice/bg_list.jpg" style="background-image: url(&quot;https://picbackup.github.io/mice/bg_list.jpg&quot;);">
            <div class="container" data-src="https://picbackup.github.io/mice/banner_series.png" style="background-image: url(&quot;https://picbackup.github.io/mice/banner_series.png&quot;);">
                <div class="row">
                    <div class="col-image">
                        <div class="icon"><img data-src="https://picbackup.github.io/mice/image_course6.png" src="./國內認證叢書_files/image_course6.png"></div>
                    </div>
                    <div class="col-list">
                        <div class="title">會議展覽叢書</div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-list">
                        <div class="english">Certification</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="pagebody-block">
            <div class="container">
                <div class="breadcrumb-outer">
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item">首頁</li>
                        <li class="breadcrumb-item">課程與認證</li>
                        <li class="breadcrumb-item">認證考試</li>
                        <li class="breadcrumb-item active">會議展覽叢書</li>
                    </ul>
                </div>
                <div class="pagetab-outer">
                    <ul class="nav nav-pills">
                        <li class="nav-item">
                            <a href="https://mice2.tako.life/meettaiwan/training/mice/books#content1" class="nav-link active" data-toggle="pill">會議展覽叢書</a>
                        </li>
                    </ul>
                </div>
                <div class="tab-content">
                    <div id="content1" class="tab-pane active">
                        <div class="card-outer book-outer">
                            <!-- Loading 狀態 -->
                            <div id="loading-books" class="text-center" style="padding: 50px;">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="sr-only">載入中...</span>
                                </div>
                                <p class="mt-3">正在載入書籍資料...</p>
                            </div>
                            <!-- Error 狀態 -->
                            <div id="error-books" class="text-center" style="padding: 50px; display: none;">
                                <div class="alert alert-danger" role="alert">
                                    <h4 class="alert-heading">載入失敗！</h4>
                                    <p id="error-message">無法載入書籍資料，請稍後再試。</p>
                                    <button class="btn btn-primary" onclick="loadBooks()">重新載入</button>
                                </div>
                            </div>
                            <!-- 書籍內容容器 -->
                            <div class="row" id="books-container">
                                <!-- 動態生成的書籍卡片將插入這裡 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- modal -->
    <div id="c-shoppingcart" class="open-block" style="overflow-y: auto;">
        <div class="open-content">
            <header class="o-header">
                <h4 class="open-title">購買清單</h4>
                <button type="button" class="close">×</button>
            </header>
            <section class="o-main">
                <div class="open-outer" id="shopCartGoods">
                    
                </div>
                <div class="total-outer">
                    <li class="list-item">
                        <div class="list-link list-link-2">
                            <div class="title">折扣</div>
                            <div class="price" id="totalDiscount">$0</div>
                        </div>
                        <div class="list-link">
                            <div class="title">總價</div>
                            <div class="price orange-2" id="totalPrice">$0</div>
                        </div>
                    </li>
                </div>
            </section>
            <footer class="o-footer">
                <button type="button" class="btn btn-buy" onclick="closeSideCart()">繼續購物</button>
                <a href="https://mice2.tako.life/meettaiwan/training/mice/shoppingCart" class="btn btn-cart">前往結帳</a>
            </footer>
        </div>
    </div>

    <div class="modal fade modal-buy" id="myBuy">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">加入購物車</h4>
                    <button type="button" class="close" data-dismiss="modal">×</button>
                </div>
                <div class="modal-body">
                    <div class="pagebuy-outer">
                        <div class="row">
                            <div class="col-image">
                                <div class="modalimage-outer">
                                    <div id="booksCover" class="image" data-src="">
                                        <img id="booksCoverImg" class="card-img-top" data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/book_00.png">
                                    </div>
                                </div>
                            </div>
                            <div class="col-content" id="booksContent">
                                <div class="pagetitle-outer">
                                    <div class="title">＃1 會展產業概論</div>
                                </div>
                                <div class="detail-outer">
                                    <p>
                                        作者：黃振家<br>
                                        譯者：張東君<br>
                                        出版社：華都文化<br>
                                        出版日期：2016-03-15<br>
                                        語言：繁體中文
                                    </p>
                                    <input type="hidden" value="0" id="idx">
                                    <div class="detail-price">定價：<span>300</span>元</div>
                                    <div class="detail-count">
                                        <div class="form-number">
                                            <a href="javascript:void(0);" class="icon-minus"></a>
                                            <input type="number" class="form-control" name="number" value="1">
                                            <a href="javascript:void(0);" class="icon-plus"></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-confirm btn-open" data-dismiss="modal" onclick="addCar()">確認購買</button>
                    <button type="button" class="btn btn-cancel" data-dismiss="modal">取消關閉</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 🆕 全局變量
        let booksList = []; // 儲存從API載入的書籍資料
        
        // 🔧 API配置 - 根據環境自動選擇
        function getApiBaseUrl() {
            // 如果是在GitHub Pages上
            if (window.location.hostname === 'jacko0322.github.io') {
                // 選項1: 使用Heroku、Vercel等部署的API
                // return 'https://your-api-domain.herokuapp.com/api';
                
                // 選項2: 使用GitHub Pages靜態JSON（臨時方案）
                return window.location.origin + '/HW2/api'; // 🔧 修正：指向 /HW2/api/ 目錄
                
                // 選項3: 使用ngrok等工具暴露本地API
                // return 'https://your-ngrok-url.ngrok.io/api';
            } else {
                // 本地開發環境
                return 'http://localhost:3000/api';
            }
        }
        
        let apiBaseUrl = getApiBaseUrl();

        // 🆕 從API載入書籍資料
        function loadBooks() {
            console.log('📚 開始載入書籍資料...');
            console.log('🔗 API地址:', apiBaseUrl);
            
            // 顯示載入狀態
            $('#loading-books').show();
            $('#error-books').hide();
            $('#books-container').empty();

            // 檢查是否為GitHub Pages環境且使用靜態檔案
            if (window.location.hostname === 'jacko0322.github.io' && apiBaseUrl.includes('github.io')) {
                loadBooksFromStaticFile();
                return;
            }

            // 調用API
            $.ajax({
                url: `${apiBaseUrl}/domestic_books`,
                method: 'GET',
                timeout: 10000, // 10秒超時
                success: function(response) {
                    console.log('✅ API回應成功:', response);
                    
                    if (response.success && response.data && response.data.books) {
                        booksList = response.data.books;
                        console.log(`📖 成功載入 ${booksList.length} 本書籍`);
                        
                        // 隱藏載入狀態
                        $('#loading-books').hide();
                        
                        // 渲染書籍
                        renderBooks();
                        
                        // 顯示統計信息
                        console.log(`📊 書籍統計 - 總數: ${booksList.length}, 價格範圍: ${Math.min(...booksList.map(b => b.price))} - ${Math.max(...booksList.map(b => b.price))} 元`);
                        
                    } else {
                        throw new Error('API回應格式不正確');
                    }
                },
                error: function(xhr, status, error) {
                    console.error('❌ 載入書籍失敗:', error);
                    console.error('❌ 狀態:', status);
                    console.error('❌ 回應:', xhr.responseText);
                    
                    // 隱藏載入狀態，顯示錯誤
                    $('#loading-books').hide();
                    $('#error-books').show();
                    
                    // 設置錯誤信息
                    let errorMsg = '無法連接到API服務器。';
                    if (status === 'timeout') {
                        errorMsg = '請求超時，請檢查網絡連接。';
                    } else if (xhr.status === 0) {
                        errorMsg = 'CORS錯誤或API服務器未運行。請確保API服務器正在運行並配置了正確的CORS設置。';
                    } else if (xhr.status === 404) {
                        errorMsg = 'API端點不存在，請檢查服務器配置。';
                    } else if (xhr.status >= 500) {
                        errorMsg = '服務器內部錯誤，請聯繫技術支援。';
                    }
                    
                    $('#error-message').html(`
                        <strong>錯誤詳情：</strong><br>
                        ${errorMsg}<br><br>
                        <strong>可能的解決方案：</strong><br>
                        1. 確保API服務器正在運行 (node server.js)<br>
                        2. 檢查CORS設置是否正確<br>
                        3. 使用本地環境測試<br>
                        4. 考慮部署API到雲端服務
                    `);
                }
            });
        }

        // 🆕 從靜態JSON檔案載入（GitHub Pages備用方案）
        function loadBooksFromStaticFile() {
            console.log('📄 從靜態檔案載入書籍資料...');
            
            $.ajax({
                url: `${apiBaseUrl}/domestic_books.json`, // 🔧 這會解析為: /HW2/api/domestic_books.json
                method: 'GET',
                dataType: 'json',
                timeout: 10000,
                success: function(data) {
                    console.log('✅ 靜態檔案載入成功:', data);
                    
                    // 適配不同的JSON結構
                    let books = [];
                    if (data.books) {
                        books = data.books;
                    } else if (data.data && data.data.books) {
                        books = data.data.books;
                    } else if (Array.isArray(data)) {
                        books = data;
                    }
                    
                    if (books.length > 0) {
                        booksList = books;
                        console.log(`📖 成功載入 ${booksList.length} 本書籍`);
                        
                        $('#loading-books').hide();
                        renderBooks();
                    } else {
                        throw new Error('靜態檔案中沒有找到書籍資料');
                    }
                },
                error: function(xhr, status, error) {
                    console.error('❌ 靜態檔案載入失敗:', error);
                    console.error('❌ 請求URL:', `${apiBaseUrl}/domestic_books.json`);
                    
                    $('#loading-books').hide();
                    $('#error-books').show();
                    $('#error-message').html(`
                        <strong>無法載入書籍資料</strong><br>
                        請求路徑: <code>${apiBaseUrl}/domestic_books.json</code><br><br>
                        <strong>請確認：</strong><br>
                        1. domestic_books.json 檔案位於 <code>/HW2/api/</code> 目錄下<br>
                        2. 檔案內容格式正確<br>
                        3. GitHub Pages 已正確部署<br><br>
                        <strong>或者：</strong><br>
                        啟動本地API服務器進行測試
                    `);
                }
            });
        }

        // 🆕 渲染書籍列表
        function renderBooks() {
            console.log('🎨 開始渲染書籍...');
            
            const container = $('#books-container');
            container.empty();
            
            if (booksList.length === 0) {
                container.html(`
                    <div class="col-12 text-center">
                        <p class="text-muted">暫無書籍資料</p>
                    </div>
                `);
                return;
            }

            // 生成每本書的HTML
            booksList.forEach((book, index) => {
                const bookHtml = generateBooks(book.id, book, index);
                container.append(bookHtml);
            });
            
            console.log(`✅ 成功渲染 ${booksList.length} 本書籍`);
        }

        // 🔄 修改原有的generateBooks函數以適配新的API資料格式
        function generateBooks(bid, book, idx) {
            // 適配API資料格式到原有格式
            const coverNumber = book.coverNumber || '00';
            const displayTitle = book.fullTitle || `＃${book.titleNumber || (idx + 1)} ${book.title}`;
            
            return `<div class="col-3">
    <div class="card">
        <div class="card-header">
            <a href="${book.bookUrl || `/meettaiwan/training/mice/books/${bid}`}">
                <div class="card-img" data-src="${book.imageUrl}" style="background-image: url('${book.imageUrl}');"></div>
            </a>
        </div>
        <div class="card-body">
            <div class="card-title">
                <a href="${book.bookUrl || `/meettaiwan/training/mice/books/${bid}`}">${displayTitle}</a>
            </div>
            <div class="card-price">訂價：<span>${book.price}</span>元</div>
            <div class="card-flex">
                <div class="card-btn">
                    <button type="button" class="btn btn-cart" data-toggle="modal" data-target="#myBuy" onclick='changeBooks(${idx})'>加入購物車</button>
                </div>
                <div class="card-btn">
                    <button type="button" class="btn btn-buy" onclick='buy(${idx})'>立即購買</button>
                </div>
            </div>
        </div>
    </div>
</div>`;
        }

        // 🔄 修改原有的changeBooks函數以適配新的資料格式
        function changeBooks(idx) {
            if (!booksList[idx]) {
                console.error('❌ 書籍索引不存在:', idx);
                return;
            }
            
            let book = booksList[idx];
            console.log('📝 更新購物車modal:', book);
            
            // 更新圖片
            $('#booksCoverImg').attr('src', book.imageUrl);
            $('#booksCoverImg').attr('data-src', book.imageUrl);
            
            // 更新標題
            $('#booksContent > div:eq(0) > div').text(book.fullTitle || book.title);
            
            // 更新描述（由於API資料中沒有abstract，使用預設描述）
            const bookDescription = `
                分類：${book.category || '會展叢書'}<br>
                幣別：${book.currency || 'TWD'}<br>
                狀態：現貨供應<br>
                ISBN：待補充<br>
                語言：繁體中文
            `;
            $('#booksContent > div:eq(1) > p').html(bookDescription);
            
            // 更新價格
            $('#booksContent > div:eq(1) > div:eq(0)').html('定價：<span>' + book.price + '</span>元');
            
            // 設置索引
            $('input#idx').val(idx);
            
            console.log('✅ Modal更新完成');
        }

        // 🔄 修改原有的getBookInfo函數以適配新的資料格式
        function getBookInfo(amt) {
            let idx = parseInt($('input#idx').val());
            console.log('🛒 獲取書籍資訊, 索引:', idx);
            
            if (!booksList[idx]) {
                console.error('❌ 書籍不存在:', idx);
                return null;
            }
            
            let book = booksList[idx];
            let amount = amt || parseInt($('input[name=number]').val()) || 1;
            
            return {
                cover: book.coverNumber || '00',
                prod: book.title,
                per: book.price,
                series: 1, // 預設series為1
                amount: amount,
                author: '待補充', // API資料中沒有作者信息
                bookId: book.id,
                category: book.category
            };
        }

        // 保持原有的購物車相關函數不變
        function addCar() {
            let data = getBookInfo();
            if (!data) {
                console.error('❌ 無法獲取書籍資訊');
                return;
            }
            
            console.log('🛒 加入購物車:', data);
            let cart = findInCart(data);
            console.log('🛒 更新後的購物車:', cart);
            
            $.cookie('cart', JSON.stringify(cart), {
                path: '/',
                secure: true
            });
            updateSideCart(cart);
        }

        function buy(idx) {
            console.log('💰 立即購買, 索引:', idx);
            changeBooks(idx);
            let data = getBookInfo(1);
            if (!data) {
                console.error('❌ 無法獲取書籍資訊');
                return;
            }
            
            console.log('💰 購買資料:', data);
            let cart = findInCart(data);
            $.cookie('cart', JSON.stringify(cart), {
                path: '/',
                secure: true
            });
            location.replace('/meettaiwan/training/mice/shoppingCart');
        }

        function findInCart(d) {
            console.log('🔍 查找購物車項目:', d);
            let cart = $.cookie("cart") ? JSON.parse($.cookie("cart")) : [];
            console.log('🛒 現有購物車:', JSON.stringify(cart));
            let flag = true;
            let cart2 = [];
            
            $.each(cart, function(index, value) {
                // 主商品
                if (value.prod == d.prod) {
                    value.amount += d.amount;
                    flag = false;
                }
                value = calTotal(value);
                cart2.push(value);
            });
            
            if (flag) {
                let data = calTotal(d);
                cart2.push(data);
            }

            return cart2;
        }

        function calTotal(d) {
            console.log('💱 計算總價:', d);
            let p = 0;
            let sum = 0;
            sum = d.amount * d.per;
            if (d.amount >= 20 && d.series == 1) {
                p = sum * 30 / 100;
            }
            return {
                author: d.author,
                cover: d.cover,
                prod: d.prod,
                amount: d.amount,
                per: d.per,
                series: d.series,
                discount: p,
                sum: sum
            };
        }

        function updateSideCart(cart) {
            console.log('🔄 更新側邊購物車:', JSON.stringify(cart));
            // 清除html
            $('#shopCartGoods').html('');
            let html = '';
            let totalDiscount = 0;
            let totalPrice = 0;
            
            $.each(cart, function(index, value) {
                let price = value.per * value.amount;
                const imageUrl = booksList.find(book => book.title === value.prod)?.imageUrl || 
                               `https://mice2.tako.life/meettaiwan/training/mice/mice/images/book_${value.cover}.jpg`;
                
                html = `<div class="open-item">
                    <img class="image" src="${imageUrl}">
                    <div class="content">
                        <div class="title">${value.prod}</div>
                        <div class="price">$${value.per} x ${value.amount} = $${price.toLocaleString()}</div>
                    </div>
                </div>`;
                $('#shopCartGoods').append(html);

                html = '';
                totalDiscount += value.discount;
                totalPrice += price;
            });

            totalPrice = totalPrice - totalDiscount;
            $('#totalDiscount').html('$' + (totalDiscount).toLocaleString());
            $('#totalPrice').html('$' + (totalPrice).toLocaleString());
            
            if (cart && cart.length > 0) {
                $('#shopcartcount').html(JSON.parse($.cookie("cart")).length);
                $('#shopcartcount').show();
                $('#collapsibleNavbar').find('li').eq(6).find('a').eq(0).find('span').eq(0).html(cart.length);
            } else {
                $('#shopcartcount').hide();
            }
        }

        function closeSideCart(){
            $('.open-block').removeClass('show');
        }

        // 🆕 頁面載入完成後自動載入書籍資料
        $(function(){
            console.log('🚀 頁面載入完成，開始初始化...');
            
            // 載入書籍資料
            loadBooks();
            
            // 初始化購物車
            if (!$.cookie("cart")) {
                $.cookie("cart", JSON.stringify([]), {
                    path: '/',
                    secure: true
                });
            }

            if (JSON.parse($.cookie("cart")).length > 0) {
                updateSideCart(JSON.parse($.cookie("cart")));
            } else {
                $('#shopcartcount').hide();
            }
            
            console.log('✅ 初始化完成');
        });
    </script>
    <!-- MAIN 結束 -->

    <!-- FOOTER -->
    <!-- 表尾 -->
<footer class="c-footer" style="padding-bottom: 0px;">
    <div class="fatfooter-block">
        <div class="container-fluid">
            <div class="row">
                <div class="col-link">
                    <div class="fatfooter-outer">
                        <ul class="nav">
                            <li class="nav-item">
                                <a href="https://mice2.tako.life/meettaiwan/training/mice/books#" class="nav-link">關於MICE</a>
                                <div class="content-menu">
                                    <a href="https://mice2.tako.life/meettaiwan/training/mice/introduction" class="content-item">計畫介紹</a>
                                    <a href="https://mice2.tako.life/meettaiwan/training/mice/benchmark" class="content-item">職能基準</a>
                                    
                                    <a href="https://mice2.tako.life/meettaiwan/training/mice/news/1" class="content-item">最新消息</a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-link">
                    <div class="fatfooter-outer">
                        <ul class="nav">
                            <li class="nav-item">
                                <a href="https://mice2.tako.life/meettaiwan/training/mice/books#" class="nav-link">課程與認證</a>
                                <div class="content-menu">
                                    <a href="https://mice2.tako.life/meettaiwan/training/mice/course/%E6%9C%83%E5%B1%95%E6%B2%99%E9%BE%8D" class="content-item">會展沙龍</a>
                                    <a href="https://mice2.tako.life/meettaiwan/training/mice/course/%E5%9C%8B%E9%9A%9B%E8%AA%8D%E8%AD%89%E5%9F%B9%E8%A8%93" class="content-item">國內認證培訓</a>
                                    <a href="https://mice2.tako.life/meettaiwan/training/mice/course/%E5%9C%8B%E5%85%A7%E8%AA%8D%E8%AD%89%E5%9F%B9%E8%A8%93" class="content-item">國內認證培訓</a>
                                    <a href="https://mice2.tako.life/meettaiwan/training/mice/exam/%E5%9C%8B%E9%9A%9B%E8%AA%8D%E8%AD%89%E8%80%83%E8%A9%A6" class="content-item">國際認證考試</a>
                                    <a href="https://mice2.tako.life/meettaiwan/training/mice/exam/%E5%9C%8B%E5%85%A7%E8%AA%8D%E8%AD%89%E8%80%83%E8%A9%A6" class="content-item">國內認證考試</a>
                                    <a href="https://mice2.tako.life/meettaiwan/training/mice/books" class="content-item">會議展覽叢書</a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-link">
                    <div class="fatfooter-outer">
                        <ul class="nav">
                            <li class="nav-item">
                                <a href="https://mice2.tako.life/meettaiwan/training/mice/books#" class="nav-link">活動花絮</a>
                                <div class="content-menu">
                                    <a href="https://mice2.tako.life/meettaiwan/training/mice/activity/video" class="content-item">影音</a>
                                    <a href="https://mice2.tako.life/meettaiwan/training/mice/activity/photo" class="content-item">照片</a>
                                    
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-data">
                    <div class="fatfooter-outer">
                        <ul class="nav">
                            <li class="nav-item">
                                <a href="javascript:void(0);" class="nav-link">聯絡我們</a>
                                <div class="content-menu">
                                    <div class="content-item">
                                        <a href="javascript:void(0);" data-toggle="modal" data-target="#openPrivacy">個人資訊隱私權保護聲明</a> | <a href="javascript:void(0);" data-toggle="modal" data-target="#openSecurity">網路使用安全相關保護聲明</a><br>
                                        主辦單位：經濟部國際貿易署、中華民國對外貿易發展協會<br>
                                        信箱：<a href="mailto:irenechen@taitra.org.tw">irenechen@taitra.org.tw</a>
                                        
                                        <br>
                                        <span id="digtiplace">訪客人數：<span class="digit-counter">3</span><span class="digit-counter">3</span><span class="digit-counter">0</span><span class="digit-counter">9</span><span class="digit-counter">2</span><span class="digit-counter">7</span><span class="digit-counter">8</span></span>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="community-outer">
                        <ul class="nav">
                            <li class="nav-item">
                                <a href="https://www.facebook.com/miceiti/" class="nav-link" target="_blank"><i class="icon"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_facebook.png"></i></a>
                            </li>
                            <li class="nav-item">
                                <a href="https://www.youtube.com/channel/UCDlAeVi8iwdXoI5Hf6KULyw" class="nav-link" target="_blank"><i class="icon"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_youtube.png"></i></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="copyright-block">
        <div class="container-fluid">
            <div class="row">
                <div class="col-logo">
                    <div class="logo"><a href="https://mice2.tako.life/meettaiwan/training/mice"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/logo_2023_07_03.png"></a></div>
                </div>
                <div class="col-copyright">
                    <div class="copyright">Copyright © 2023 經濟部國際貿易署 版權所有</div>
                </div>
            </div>
        </div>
    </div>
</footer>

<section class="c-right">
    <div class="rightlink-block">
        <div class="rightmenu-outer">
            <ul class="nav flex-column">
                <li class="nav-item"><a href="https://mice2.tako.life/meettaiwan/training/mice/books#" class="nav-link btn-open cart-back"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_shoppingcart.png" src="./國內認證叢書_files/icon_shoppingcart.png"><span id="shopcartcount" style="display: none;"></span></a></li>
                <script>
                    if (!$.cookie("cart")) $.cookie("cart", JSON.stringify([]), {
                        path: '/',
                        secure: true
                    })

                    if (JSON.parse($.cookie("cart")).length > 0) {
                        // $('#shopcartcount').html(JSON.parse($.cookie("cart")).length);
                        updateSideCart(JSON.parse($.cookie("cart")))
                    } else {
                        $('#shopcartcount').hide();
                    }
                </script>
                <li class="nav-item"><a href="https://mice2.tako.life/register" class="nav-link"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_register.png" src="./國內認證叢書_files/icon_register.png"></a></li>
                <li class="nav-item"><a href="https://www.facebook.com/miceiti/" class="nav-link" target="_blank"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_facebook.png" src="./國內認證叢書_files/icon_facebook.png"></a></li>
                <li class="nav-item"><a href="https://www.youtube.com/channel/UCDlAeVi8iwdXoI5Hf6KULyw" class="nav-link" target="_blank"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_youtube.png" src="./國內認證叢書_files/icon_youtube.png"></a></li>
                <li class="nav-item"><a href="https://mice2.tako.life/meettaiwan/training/mice/books#" class="nav-link"><img data-src="https://mice2.tako.life/meettaiwan/training/mice/mice/images/icon_top.png" src="./國內認證叢書_files/icon_top.png"></a>
                </li>
            </ul>
        </div>
    </div>
</section>


<div class="modal fade modal-buy" id="openPrivacy">
    <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">個人資訊隱私權保護聲明</h4>
                <button type="button" class="close" data-dismiss="modal">×</button>
            </div>
            <div class="modal-body">
                <div class="detail-outer">
                    <div class="subtitle">個人資料保護聲明</div>
                    <p>中華民國對外貿易發展協會（包含具有關係企業關係之法人或組織團體，如台灣貿易中心等，詳官方網站，以下統稱「本會」）尊重並致力保護您的個人隱私及個人資料，訂有「外貿協會官網」，並依個人資料保護法第8條規定，告知以下事項：</p>
                    <div class="subtitle">1. 蒐集目的</div>
                    <p>協助廠商發展中華民國對外貿易、其他公共部門（包括行政法人、政府捐助財團法人及其他公法人）執行相關業務；貿易推廣及管理；網路購物及其他電子商務服務；客戶管理與服務；中小企業及其他產業之輔導；政令宣導；教育或訓練行政；圖書出版品管理；廣告或商業行為管理；行銷；契約、類似契約或其他法律關係事務；商業與技術資訊；資(通)訊服務；資(通)訊與資料庫管理；資通安全與管理；調查、統計與研究分析；以及非公務機關依法定義務所進行個人資料之蒐集處理及利用等。</p>
                    <div class="subtitle">2. 個人資料類別</div>
                    <p>識別類、社會情況、及/或其他各類依蒐集目的所必要之個人資料等。</p>
                    <div class="subtitle">3. 個人資料處理、利用之期間、地區、對象及方式</div>
                    <ol><li>期間：個人資料蒐集之特定目的存續期間、或依相關法令或契約約定之保存年限、或本會因執行業務所必須之保存期間（較法令或契約約定期間長者），或另經您同意之較長期間。</li>
					<li>地區：包括中華民國、本會各駐點及其轄區之國家、未受中央目的事業主管機關限制之國際傳輸個人資料之接收者所在地、個人資料利用對象之所在地，以及本會業務往來機構之所在地。</li>
					<li>對象：您的資料可能會提供給本會的代理人、簽約人、提供線上付款認證或其他相關服務之服務供應商、及合作夥伴（例如PayPal、網際威信、各收單銀行、各支付或收付款服務提供機構、各物流業者、各認證服務業者、eBay及其他與本會合作的交易平臺）、未受中央目的事業主管機關限制之國際傳輸個人資料之接收者、其他與本會有業務往來之機構、法院、及/或政府主管機關。</li>
					<li>方式：以自動化機器或其他非自動化之方式為蒐集、處理、利用與國際傳輸。</li>
					</ol>
					<div class="subtitle">4. 依個人資料保護法規定得行使之權利與方式 就您的個人資料，依個人資料保護法規定，您有權：</div>
					<ol><li>查詢或請求閱覽、及請求製給複製本，本會得酌收必要成本費用；</li>
					<li>請求補充或更正，惟依法您應為適當之釋明；</li>
					<li>請求停止蒐集、處理或利用、及請求刪除，但因本會執行職務或業務所必須者，得依法不依您的請求為之；及</li>
					<li>如利用您的個人資料行銷時，您得表示拒絕接受行銷。如您欲行使上述權利，敬請email至<a href="mailto:training@meettaiwan.com">training@meettaiwan.com</a>或致電外貿協會02-2725-5200。</li></ol>
					<div class="subtitle">5. 不提供個人資料所致權益之影響</div>
					<p>如不同意提供資料，將無法接受本會所提供之服務。</p>
					<div class="subtitle">6. 已確認所提供之個人資料真實且正確；如事後有異動情形，將即檢具相關證明文件送交本會辦理更正。</div>
					<br><br>
					<div class="subtitle">隱私權政策</div>
					<p>本隱私權政策說明財團法人中華民國對外貿易發展協會（「外貿協會」或「我們」），使用和保護經由外貿協會官網（網址：https://mice.meettaiwan.com/meettaiwan/training/MICE/）（「本網站」）收集網站訪客(「訪客」)資料之政策與方法。本網站之隱私權保護係依照中華民國個人資料保護法，所有使用者均受本隱私權政策保障，且於開始使用本網站時，即表示同意本內容規定之隱私權政策。</p>
					<div class="subtitle">1. 定義</div>
					<p>您與外貿協會簽訂之會員合約中定義之名詞，若使用於本隱私權政策內，應具有相同之意義（但本政策另有明示規定或因上下文需求者，不在此限）。</p>
					<div class="subtitle">2. 資料蒐集之目的</div>
					<p>外貿協會可能會為其提供之查詢外貿協會的展覽、活動相關資訊及本網站之其他服務，以及外貿協會之行銷服務和特別活動等目的，或您同意之其他目的，蒐集訪客資料。</p>
					<div class="subtitle">3. 資料之類別</div>
					<p>在營運本網站時，我們可能會收集且處理以下與您有關的資料：</p>
					<ol><li>因填寫我們網站上之表格而提供之資料，例如，於註冊或進行採購時提供之資料，包括但不限於您的姓名、地址、電話／傳真號碼、電子郵件、公司簡介、產品目錄、貿易公告(trade leads)、帳單資料、信用卡號、支票或匯票之到期日和相關資料，以及與您有關的其他營業資料。</li>
					<li>訪問本網站之詳細內容以及存取之資源，包括但不限於流量資料、地點資料、weblogs和其他傳送之資料。</li>
					<li>因故透過本網站與我們或其他人聯絡時，提供給我們或其他人之資料。</li>
					<li>其他您提供給本網站或我們的資料。</li>
					</ol>
					<div class="subtitle">4. 資料利用之期間、地區、對象及方式</div>
					<p>外貿協會針對訪客經本網站提供之所有個人資料，均符合台灣個資法之保密政策，且外貿協會將依據會員與外貿協會間之協議，使用及/或發布提供之資料。</p>
					<p>您的個人資料將由外貿協會保留，至您正式要求我們删除您的個人資料為止，但法律另有規定者，不在此限。</p>
					<p>本網站收集之資料，可能會儲存於外貿協會營運之任何國家及於該國家內進行處理，當您使用本網站後，您即同意得將資料傳遞至您本國以外之地區。</p>
					<p>外貿協會可能會將您的資料提供給其代理人、簽約人、提供線上付款認證或其他相關服務之服務供應商、及/或合作夥伴（例如PayPal、網際威信、各收單銀行、各支付或收付款服務提供機構、各物流業者、各認證服務業者、eBay及其他與本會合作的交易平臺）以提供本網站之服務。當會員申請線上付款服務時，服務供應商／PayPal可能會為提供線上付款服務之目的，收集會員之其他資料（例如信用卡號）。有時，我們會為提供服務和提供網站使用之統計資料給我們的合作夥伴，而收集與您有關的電腦資料。</p>
					<p>我們得利用cookie檔案收集與您有關的一般網路使用資料。使用時，這些cookies會自動下載至您的電腦中，該cookie檔案係儲存於您的電腦硬碟上，以儲存移轉至您的電腦硬碟上之資料，協助我們改進我們的網站和提供給您的服務。您得拒絕我們利用cookies，您只要開啓瀏覽器上的相關設定，即能拒絕cookies。請注意，若您選擇拒絕cookies，可能無法存取我們網站上的特定部分內容。本網站之第三服務提供人亦可利用cookies，我們並未進行控管，因此，當您使用該第三服務提供人經本網站提供之服務時，該cookies（若有）可能會被下載。</p>
					<div class="subtitle">5. 查詢和修正</div>
					<p>就您的個人基本資料，您有權查詢或請求閱覽、請求製給複製本、請求補充或更正、請求停止蒐集、處理或利用、請求刪除，但法律另有規定者，不在此限。您得經網站登入本身之帳號為所述查詢與修正，您亦得聯絡我們進行申請。</p>
					<div class="subtitle">6. 未提供資料對您權益之影響</div>
					<p>如您未提供相關資料，您可能無法享有本網站所提供的服務或達成您使用本網站之目的，例如，您可能無法於本網站順利進行線上交易。</p>
					<div class="subtitle">7. 本隱私權政策之變更</div>
					<p>若本隱私權政策有任何變更，我們會在本網站上張貼修正和新版之隱私權政策。該修正和新版之隱私權政策經張貼後將立即生效，但我們另有規定者，不在此限。您同意，本網站收集之所有資料（無論在新政策生效前或後收集之資料），均應受當時生效之最新隱私權政策規範。您若不同意本隱私權政策之最新變更，應以書面聯絡外貿協會，並特別要求外貿協會歸還及/或銷毀其所持有與您有關之個人資料的所有複製本。</p>
					<div class="subtitle">8. 語言</div>
					<p>如本隱私權政策之其他翻譯版本與繁體中文版本有任何歧異，以繁體中文版本為準。</p>
					<div class="subtitle">9. 問題或建議</div>
					<p>您若有任何問題或建議，請以電子郵件寄至：<a href="mailto:training@meettaiwan.com">training@meettaiwan.com</a>。</p>
                </div>
            </div>
            <div class="modal-footer justify-content-center">
                <div class="back-outer">
                    <button type="button" class="btn btn-confirm" data-dismiss="modal">關閉</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade modal-buy" id="openSecurity">
    <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">網路使用安全相關保護聲明</h4>
                <button type="button" class="close" data-dismiss="modal">×</button>
            </div>
            <div class="modal-body">
                <div class="detail-outer">
                    <div class="subtitle">著作權聲明</div>
                    <ol>
                        <li>智慧所網站上刊載之所有內容，包括文字敘述、攝影、圖片、錄音、影像與其他資訊，均受著作權法保護，在著作權法下，對於本中心網站上之資訊，使用者可作為私人使用，惟須註明出處。若是重製部分或全部網頁，未經本所許可，不得為之。
                        </li>
                        <li>本中心網站上所刊載以本中心名義公開發表之著作，在合理範圍內，得重製、公開播送或公開傳輸；惟利用本中心前述著作時，請明示其出處。至於著作之合理使用，請參考著作權法第六十五條之規定。
                        </li>
                        <li>本中心網站資訊內容若有其他著作權人之著作內容，則必須取得該著作權人同意後，方得刊載。</li>
                        <li>除了合於著作權法第八十條之一非移除或變更，否則無法合法利用著作；或者因為錄製或傳輸系統轉換時，技術上必須要移除或變更的情況之外，本中心網站所標示之權利管理電子資訊，未經許可，不可以移除或變更。
                        </li>
                    </ol>
                    <div class="subtitle">連結至本所網站</div>
                    <p>一般而言，任何網站連結至本中心網站，毋須經過本中心同意，然而連結須明白標示本中心名稱，若是連結會誤導使用者，本中心將不允許此連結行為。</p>
                    <div class="subtitle">本中心網站之相關連結</div>
                    <p>為供網路使用者便利，本中心網站僅提供相關網站之連結，對利用人涉及該網站內容之使用行為，本中心不負責任。</p>
                    <div class="subtitle">免責聲明</div>
                    <p>本中心網站所提供相關連結網站之網頁或資料，均為被連結網站所提供，相關權利為該等網站或合法權利人所有，本中心不擔保其正確性、即時性或完整性。</p>
                </div>
            </div>
            <div class="modal-footer justify-content-center">
                <div class="back-outer">
                    <button type="button" class="btn btn-confirm" data-dismiss="modal">關閉</button>
                </div>
            </div>
        </div>
    </div>
</div>
    <!-- FOOTER 結束  -->

    <script>
        $(function() {
            let pics = $('[data-src]');
            lazyload(pics);
            $.ajax({
                type: 'GET',
                url: '/meettaiwan/training/mice/vr-set',
                success: function(res) {
                    if (res == 'active') $('#vrswitch').show();
                }
            }).then(function() {
                $.ajax({
                    url: '/meettaiwan/training/mice/log',
                    data: {
                        para: window.location.href
                    },
                    success: function(res) {
                        let appStr = '';
                        if (res.state == 'error') return '';
                        if (!res.data) res.data = 0;
                        let str = res.data.toString();
                        for (let i = 0; i < str.length; i++) {
                            appStr += `<span class="digit-counter">${str.charAt(i)}</span>`;
                        }
                        $('#digtiplace').html('訪客人數：' + appStr);
                        let pathname = window.location.pathname;
                        if (res.warn && pathname !== '/meettaiwan/training/mice/personal') {
                            Swal.fire({
                                title: '您的密碼已經很久沒有更新，建議更新密碼',
                                showDenyButton: true,
                                showCancelButton: true,
                                confirmButtonText: '立即更新密碼',
                                denyButtonText: `延後三個月`,
                                cancelButtonText: `等下再說`,
                            }).then((result) => {
                                if (result.isConfirmed) {
                                    location.href = "/meettaiwan/training/mice/personal";
                                } else if (result.isDenied) {
                                    $.ajax({
                                url: '/meettaiwan/training/mice/later-update',
                                type:'POST'
                            });
                                    Swal.fire('已延後更新', '', 'info')
                                }
                            })
                        }
                    }
                });
            })

        })
    </script>



<div id="trend_notification_app" class="trend_notification_app_outer"><div id="trend_notification"><div id="trend_notification_con"></div></div></div><div id="UMS_TOOLTIP" style="position: absolute; cursor: pointer; z-index: 2147483647; background: transparent; top: -100000px; left: -100000px;"></div></body><umsdataelement id="UMSDataElement" style="display: none;"></umsdataelement><div id="tmtoolbar_manual_rating_injected" style="display: none;">init</div><div id="UMSSendDataEventElement" style="display: none;">init</div></html>
